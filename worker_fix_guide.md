# 엑셀 파일 수정 가이드

## 📝 Employee ID를 텍스트로 변환하는 방법

### Excel (엑셀)에서:

1. **Employee ID 열 전체 선택**
   - D열 헤더를 클릭하여 열 전체 선택

2. **셀 서식 설정**
   - 마우스 우클릭 → "셀 서식" 선택
   - 또는 `Ctrl + 1` (Windows) / `Cmd + 1` (Mac)

3. **텍스트 형식으로 변경**
   - "표시 형식" 탭에서 "텍스트" 선택
   - "확인" 클릭

4. **데이터 재입력 (중요!)**
   - 형식을 변경한 후에는 각 셀을 더블클릭하여 편집 모드로 들어간 후
   - `Enter`를 눌러 변경사항 적용
   - **또는** 전체 데이터를 복사한 후 "선택하여 붙여넣기" → "값" 선택

5. **파일 저장**
   - `Ctrl + S` 또는 "파일" → "저장"

---

### Google Sheets에서:

1. **Employee ID 열 선택**
   - D열 헤더 클릭

2. **형식 메뉴**
   - 상단 메뉴에서 "형식" → "숫자" → "일반 텍스트" 선택

3. **파일 다운로드**
   - "파일" → "다운로드" → "Microsoft Excel (.xlsx)"

---

## 🔧 대안 방법: Employee ID 앞에 작은따옴표 추가

가장 간단한 방법입니다!

### 방법:
1. Employee ID 셀 편집 시작
2. 셀 내용 앞에 **작은따옴표(')** 추가
   - 예: `3452` → `'3452`
3. Enter 키 누르기
4. 모든 Employee ID에 동일하게 적용

**왜 이렇게 하나요?**
- 작은따옴표는 엑셀에서 "이 값은 텍스트입니다"라는 의미
- 셀에는 표시되지 않지만, 데이터는 텍스트로 저장됨

---

## 📊 수정 전/후 비교

### ❌ 수정 전 (문제 있는 상태)
```
Employee ID 셀 값: 3452 (숫자 타입)
셀 서식: 일반 또는 숫자
```

### ✅ 수정 후 (올바른 상태)
```
Employee ID 셀 값: '3452 또는 "3452" (텍스트 타입)
셀 서식: 텍스트
```

---

## 🧪 수정이 제대로 되었는지 확인하는 방법

1. **Employee ID 셀 클릭**
2. **수식 입력줄 확인**
   - 숫자가 **오른쪽 정렬**되어 있으면 → 숫자 타입 (문제)
   - 숫자가 **왼쪽 정렬**되어 있으면 → 텍스트 타입 (정상)

3. **또는 다음 수식 사용**
   - 빈 셀에 `=TYPE(D2)` 입력
   - 결과가 `1`이면 → 숫자 타입
   - 결과가 `2`이면 → 텍스트 타입 (정상)

---

## 📤 수정 후 업로드 단계

1. **수정된 엑셀 파일 저장**
2. **브라우저 새로고침** (`F5` 또는 `Ctrl + R`)
3. **작업자 등록 페이지 접속**
4. **파일 선택**
5. **작업자 업로드 버튼 클릭**

---

## ⚠️ 여전히 실패하는 경우

### 방법 A: 브라우저 개발자 도구 확인

1. **개발자 도구 열기**
   - `F12` 키 누르기
   - 또는 마우스 우클릭 → "검사" 선택

2. **Console 탭 선택**

3. **파일 업로드 시도**

4. **빨간색 에러 메시지 확인**
   - 에러 메시지를 복사하여 알려주세요

5. **Network 탭 확인**
   - "Network" 탭 선택
   - 파일 업로드 시도
   - `/api/workers/bulk` 요청 클릭
   - "Response" 탭에서 서버 응답 확인

### 방법 B: 작은 단위로 테스트

1. **엑셀 파일에서 처음 5개 행만 남기기**
   - 헤더 + 5명의 데이터
2. **새 파일로 저장**
3. **업로드 테스트**
4. **성공하면 점진적으로 데이터 추가**

### 방법 C: 중복 데이터 확인

현재 시스템에 이미 등록된 작업자가 있을 수 있습니다.

1. **작업자 등록 페이지에서 "등록된 작업자 현황" 확인**
2. **동일한 Employee ID가 있는지 확인**
3. **있다면 해당 데이터를 엑셀에서 삭제**

---

## 📞 추가 도움이 필요한 경우

다음 정보를 제공해주세요:

1. **브라우저 콘솔 에러 메시지** (F12 → Console 탭)
2. **네트워크 응답** (F12 → Network 탭 → /api/workers/bulk)
3. **수정한 방법** (위의 방법 중 어떤 것을 시도했는지)
4. **실패 시점** (파일 선택 시? 업로드 버튼 클릭 시?)

---

## ✅ 요약

귀하의 엑셀 파일은 데이터 자체에는 문제가 없습니다!

**가장 가능성 높은 원인**: Employee ID가 숫자 타입으로 저장되어 있음

**해결 방법**:
1. Employee ID 열을 텍스트 형식으로 변경
2. 또는 각 ID 앞에 작은따옴표(') 추가
3. 파일 저장 후 다시 업로드

이렇게 수정하면 99% 업로드가 성공할 것입니다! 🎉
